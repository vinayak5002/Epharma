DROP DATABASE if exists epharma_customer;
CREATE DATABASE epharma_customer;
USE epharma_customer;

CREATE TABLE PRIME_PLANS(
	PLAN_ID INT PRIMARY KEY,
	PLAN_NAME VARCHAR(20),
	PLAN_DESCRIPTION VARCHAR(255)
);
INSERT INTO PRIME_PLANS VALUES (1, 'MONTHLY', 'For Rs. 199 get health coins equal to 10% on every payment using debit card or 15% (on credit card) for 1 month');  
INSERT INTO PRIME_PLANS VALUES (2, 'QUARTERLY', 'For Rs. 399 get health coins equal to 10% on every payment using debit card or 15% (on credit card) for 3 months');
INSERT INTO PRIME_PLANS VALUES (3, 'YEARLY', 'For Rs. 699 get health coins equal to 10% on every payment using debit card or 15% (on credit card) for 1 year');

CREATE TABLE CUSTOMER (
	CUSTOMER_ID INT AUTO_INCREMENT,
	CUSTOMER_NAME VARCHAR(30) NOT NULL,
	CUSTOMER_EMAIL_ID VARCHAR(30) NOT NULL,
	CONTACT_NUMBER VARCHAR(10) NOT NULL,
	GENDER VARCHAR(10),
	DATE_OF_BIRTH DATE,
	PASSWORD VARCHAR(70) NOT NULL,
    PLAN_ID INT,
	PLAN_EXPIRY_DATE DATE,
	HEALTH_COINS INT,
	CONSTRAINT EPHARMACY_CUST_PK primary key ( CUSTOMER_ID ),
    CONSTRAINT EPHARMACY_CUST_PLAN__FK FOREIGN KEY (PLAN_ID) REFERENCES PRIME_PLANS (PLAN_ID)
);

INSERT INTO CUSTOMER (CUSTOMER_ID, CUSTOMER_NAME, CUSTOMER_EMAIL_ID, CONTACT_NUMBER, GENDER, DATE_OF_BIRTH, PASSWORD) VALUES (101, 'JOHN', 'john@infosys.com', '8875632142', 'Male','1999/09/09','john@123');
INSERT INTO CUSTOMER (CUSTOMER_ID, CUSTOMER_NAME, CUSTOMER_EMAIL_ID, CONTACT_NUMBER, GENDER, DATE_OF_BIRTH, PASSWORD) VALUES (102, 'STEVE', 'steve@infosys.com', '9880253413', 'Male','1998/09/02','steve@123');
INSERT INTO CUSTOMER (CUSTOMER_ID, CUSTOMER_NAME, CUSTOMER_EMAIL_ID, CONTACT_NUMBER, GENDER, DATE_OF_BIRTH, PASSWORD) VALUES (103, 'HARSHAL', 'harshal@infosys.com', '8408871600','Male','2000/09/09', 'harshal@123');
INSERT INTO CUSTOMER (CUSTOMER_ID, CUSTOMER_NAME, CUSTOMER_EMAIL_ID, CONTACT_NUMBER, GENDER, DATE_OF_BIRTH, PASSWORD) VALUES (104, 'SHAHRUKH', 'shah@infosys.com', '9548742258','Male','2001/02/01', 'shahrukh@123');
INSERT INTO CUSTOMER (CUSTOMER_ID, CUSTOMER_NAME, CUSTOMER_EMAIL_ID, CONTACT_NUMBER, GENDER, DATE_OF_BIRTH, PASSWORD) VALUES (105, 'ROSE', 'rose@infosys.com', '9476888203','Female','1999/12/24', 'rose@123');
INSERT INTO CUSTOMER (CUSTOMER_ID, CUSTOMER_NAME, CUSTOMER_EMAIL_ID, CONTACT_NUMBER, GENDER, DATE_OF_BIRTH, PASSWORD) VALUES (106, 'adesh', 'adesh@infosys.com', '7037520915', 'Male','2003/11/15','adesh@123');
INSERT INTO CUSTOMER (CUSTOMER_ID, CUSTOMER_NAME, CUSTOMER_EMAIL_ID, CONTACT_NUMBER, GENDER, DATE_OF_BIRTH, PASSWORD) VALUES (112, 'pavan', 'pavan@infosys.com', '7830182434', 'Male','1999/11/15','pavan@123');



CREATE TABLE CUSTOMER_ADDRESS (
	ADDRESS_ID INT AUTO_INCREMENT,
	CUSTOMER_ID INT,
	ADDRESS_NAME VARCHAR(15) ,
	ADDRESS_LINE1 VARCHAR(30) ,
	ADDRESS_LINE2 VARCHAR(30) ,
	AREA VARCHAR(20) ,
	CITY VARCHAR(17) ,
	STATE VARCHAR(20) ,
	PINCODE INT ,
	CONSTRAINT EPHARMACY_CUST_ADDR_PK primary key ( ADDRESS_ID ),
	CONSTRAINT EPHARMACY_CUST_ADDR__FK FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMER (CUSTOMER_ID)
);

INSERT INTO CUSTOMER_ADDRESS VALUES (1,101,'Home','40A, Prestige Apartments','Gunjur Mohalla','Anand Vihar','Noida','Uttar Pradesh',110029);
INSERT INTO CUSTOMER_ADDRESS VALUES (2,101,'Work','Reliance Industrial Area','Diamond City','Vasant Vihar','Delhi','Delhi',110029);
INSERT INTO CUSTOMER_ADDRESS VALUES (3,103,'Home','A2/1, Indira Colonies','Lalvani Nagar','Baner','Pune','Maharashtra',411037);
INSERT INTO CUSTOMER_ADDRESS VALUES (4,103,'Work','A705, AjayDeep Complex','Lalvani nagar','Kothrud','Pune','Maharashtra',411037);
INSERT INTO CUSTOMER_ADDRESS VALUES (5,105,'Home','309, Leo Janani Apartments','Lakshmikanth nagar','Rajouri Garden','Delhi','Delhi',110027);
INSERT INTO CUSTOMER_ADDRESS VALUES (6,104,'Home','187, Sumeru Nilaya','6th Cross Road','Madegowda Circle','Mysore','Karnataka',570016);
INSERT INTO CUSTOMER_ADDRESS VALUES (7,106,'Home','187, Sumeru Nilaya','6th Cross Road','Madegowda Circle','Mysore','Karnataka',570016);
INSERT INTO CUSTOMER_ADDRESS VALUES (null,112,'office','187, post office road','clement town','shubhash nagar','Dehradun','uttarkhand',248002);

CREATE TABLE PASSWORD_HISTORY(
	ID INT AUTO_INCREMENT PRIMARY KEY,
	CUSTOMER_ID INT NOT NULL,
	oldPassword VARCHAR(70) NOT NULL,
    newPassword VARCHAR(70) NOT NULL,
	confirmPassword VARCHAR(70) Not NULL
);
insert into PASSWORD_HISTORY VALUES(null,111,"tanuj@123","tanuj@123","yes");


CREATE TABLE ORDER_DETAILS (
    ORDER_ID INT PRIMARY KEY,
    MRP_TOTAL DECIMAL(7,2),
    DISCOUNT_PERCENT INT,
    DISCOUNTED_TOTAL DECIMAL(7,2),
    DELIVERY_DATE DATETIME,
    ORDER_STATUS ENUM('PROCESSING', 'CONFIRMED', 'CANCELLED', 'COMPLETED'),
    ORDER_DATE DATETIME,
    CANCEL_REASON VARCHAR(500),
    DELIVERY_STATUS ENUM('AWAITING_CONFIRMATION', 'DELIVERED', 'IN_TRANSIT', 'OUT_FOR_DELIVERY', 'CANCELLED'),
    CUSTOMER_ID INT,
    ADDRESS_ID INT,
    CARD_ID VARCHAR(16)
);

INSERT INTO ORDER_DETAILS (
    ORDER_ID, MRP_TOTAL, DISCOUNT_PERCENT, DISCOUNTED_TOTAL, DELIVERY_DATE, 
    ORDER_STATUS, ORDER_DATE, CANCEL_REASON, DELIVERY_STATUS, 
    CUSTOMER_ID, ADDRESS_ID, CARD_ID
) VALUES
    (1, 150.00, 10, 135.00, '2024-09-15 10:00:00', 'PROCESSING', '2024-09-01 09:00:00', NULL, 'AWAITING_CONFIRMATION', 101, 201, '1234567812345678'),
    (2, 200.00, 5, 190.00, '2024-09-20 12:00:00', 'CONFIRMED', '2024-09-02 10:00:00', NULL, 'IN_TRANSIT', 102, 202, '2345678923456789'),
    (3, 300.00, 15, 255.00, '2024-09-25 15:00:00', 'COMPLETED', '2024-09-03 11:00:00', NULL, 'DELIVERED', 103, 203, '3456789034567890'),
    (4, 250.00, 20, 200.00, '2024-10-01 14:00:00', 'CANCELLED', '2024-09-04 12:00:00', 'Customer changed mind', 'CANCELLED', 104, 204, '4567890145678901'),
    (5, 180.00, 10, 162.00, '2024-10-05 09:00:00', 'PROCESSING', '2024-09-05 08:00:00', NULL, 'OUT_FOR_DELIVERY', 105, 205, '5678901256789012');






-- this is in epharma_cart schema
-- done in database
CREATE TABLE CUSTOMER_CART (
	CART_ID INT auto_increment,
    CUSTOMER_ID INT REFERENCES CUSTOMER(CUSTOMER_ID),
    MEDICINE_ID INT REFERENCES MEDICINE(MEDICINE_ID),
    QUANTITY SMALLINT,
	constraint CART_ID_PK primary key (CART_ID)
);

INSERT INTO CUSTOMER_CART (CART_ID, CUSTOMER_ID, MEDICINE_ID, QUANTITY) VALUES (7300,  101, 1011, 2);
INSERT INTO CUSTOMER_CART (CART_ID, CUSTOMER_ID, MEDICINE_ID, QUANTITY) VALUES (7301,  102, 1020, 1);
INSERT INTO CUSTOMER_CART (CART_ID, CUSTOMER_ID, MEDICINE_ID, QUANTITY) VALUES (7302,  103, 1030, 1);
INSERT INTO CUSTOMER_CART (CART_ID, CUSTOMER_ID, MEDICINE_ID, QUANTITY) VALUES (7303,  104, 1030, 1);
INSERT INTO CUSTOMER_CART (CART_ID, CUSTOMER_ID, MEDICINE_ID, QUANTITY) VALUES (7304,  105, 1022, 3);

CREATE TABLE CARD(
	CARD_ID VARCHAR(16),
	NAME_ON_CARD VARCHAR(50),
	CVV VARCHAR(70),
	CARD_TYPE ENUM('DEBIT_CARD','CREDIT_CARD'),
	EXPIRY_DATE DATE,
	CUSTOMER_ID INT REFERENCES CUSTOMER(CUSTOMER_ID)
);


commit;
select * from CUSTOMER;
select * from CUSTOMER_ADDRESS;
select * from PASSWORD_HISTORY;